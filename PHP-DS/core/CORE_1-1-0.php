<?php
//----------------------------------------------------------------------------------------------------
// SINIF, FONKSİYON YAPILARI ve İÇERİKLERİ İÇİN DİL DESTEĞİ UYGULAMASI
//----------------------------------------------------------------------------------------------------
//
// Yazar      : Berkay Karataş <berkaykarats@icloud.com> 
// Site       : 
// Lisans     : The MIT License
// Copyright  : Copyright (c) 2017, TÜRKÇE FRAMEWORK
//
//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------
// Namespace
//----------------------------------------------------------------------------------------------------
namespace Berkay;
//----------------------------------------------------------------------------------------------------
// Çekirdek dosya için kök dizin bul
//----------------------------------------------------------------------------------------------------
define( 'KÖK_DİZİN_ÇEKİRDEK', dirname(__FILE__) ); 
// ---------------------------------------------------------------------------------------------------
// Çekirdek bağımlılıkları
//----------------------------------------------------------------------------------------------------
include(KÖK_DİZİN_ÇEKİRDEK."/bagimliliklar.php");
// ---------------------------------------------------------------------------------------------------
// Erişim yolu
//----------------------------------------------------------------------------------------------------
define('ERİŞİM_YOLU',$_SERVER["PHP_SELF"]);
// ---------------------------------------------------------------------------------------------------
// Erişilemez yollar
//----------------------------------------------------------------------------------------------------
$erişilemez_yollar = strstr(ERİŞİM_YOLU, "CORE_1-1-0.php");
// ---------------------------------------------------------------------------------------------------
// Direk erişim haline
//----------------------------------------------------------------------------------------------------
if($erişilemez_yollar)
{
// ---------------------------------------------------------------------------------------------------
// Sistemi durdur
//----------------------------------------------------------------------------------------------------
PHP_DS_bağımlılık::sistemi_durdur();
}
//----------------------------------------------------------------------------------------------------
// Dil_Destekli_Sınıf başlangıcı
//----------------------------------------------------------------------------------------------------
class PHP_DS
{
// ---------------------------------------------------------------------------------------------------
// Değişkenler
//----------------------------------------------------------------------------------------------------
  public $dosya               =                    null;
  public $kod                 =                    null;
  public $desteklenecek       =                    null;
  public $sınıf               =                    "sınıf";
  public $kullanım            =                    "durağan";
  public $fonksiyon_v         =                    "Fonksiyon";
  public $değişken_v          =                    "degisken";
// ---------------------------------------------------------------------------------------------------
// Kurucu fonksiyon
//----------------------------------------------------------------------------------------------------
  function __construct($dosya=null)
  {
// ---------------------------------------------------------------------------------------------------
// Alınan dil dosyasını bir değişkene ata
//----------------------------------------------------------------------------------------------------
  $this->dosya = $dosya;
// ---------------------------------------------------------------------------------------------------
// Değişken boşsa
//----------------------------------------------------------------------------------------------------
  if($this->dosya==null)
  {
// ---------------------------------------------------------------------------------------------------
// Dil dosyası bulunamadı hatası
//----------------------------------------------------------------------------------------------------
    die("Dil_Desteği, dil dosyası olmadan sağlanamaz.");
  }
//----------------------------------------------------------------------------------------------------
  }
// ---------------------------------------------------------------------------------------------------
// Dil desteği sağlama fonksiyonu
//----------------------------------------------------------------------------------------------------
  public function ekle()
  {
// ---------------------------------------------------------------------------------------------------
// Eğer belirtilen dil dosyası bulunamazsa
//----------------------------------------------------------------------------------------------------
    if(!@include($this->dosya))
    {
// ---------------------------------------------------------------------------------------------------
// Hata
//----------------------------------------------------------------------------------------------------
      die ("Belirtilen dil dosyası bulunamadı.\n".$this->dosya);
//----------------------------------------------------------------------------------------------------
    }
// ---------------------------------------------------------------------------------------------------
// Kod oluşturucu fonksiyonu çağır
//----------------------------------------------------------------------------------------------------
$this->oluştur($dil,$this->kod);
//----------------------------------------------------------------------------------------------------
}
// ---------------------------------------------------------------------------------------------------
// Kod oluşturucu fonksiyon
//----------------------------------------------------------------------------------------------------
private function oluştur($dil=null,$kod=null)
{
//----------------------------------------------------------------------------------------------------
// ANAHTARLAR
//----------------------------------------------------------------------------------------------------
//
// Kullanılabilir: __callStatic , __call     : 
$anahtar_= null;
switch ($this->kullanım) {
  case 'durağan':
    $kullanım="__callStatic";
    $anahtar_="public static";
    break;
  
  default:
    $kullanım="__call";
    $anahtar_="public";
    break;
}
//----------------------------------------------------------------------------------------------------
// ANAHTARLAR BİTİŞ
//----------------------------------------------------------------------------------------------------
// ---------------------------------------------------------------------------------------------------
// DİL DOSYASINA GÖRE KODU OLUŞTUR
//----------------------------------------------------------------------------------------------------
// Fonksiyonların Detayları
//----------------------------------------------------------------------------------------------------
$fonksiyon_sayısı=  substr_count($kod, $this->fonksiyon_v);
// ---------------------------------------------------------------------------------------------------
// İndexler
//----------------------------------------------------------------------------------------------------
$i = $fonksiyon_sayısı;
$orta = null;
// ---------------------------------------------------------------------------------------------------
// Loop by function sequence
//----------------------------------------------------------------------------------------------------
do
{
// ---------------------------------------------------------------------------------------------------
// Destek kodlarının gövde bölümü
//----------------------------------------------------------------------------------------------------
  $orta= $orta. ' case @'.$dil['F'.$i].': return call_user_func_array(array(@'.$dil[$this->sınıf].',"'.$this->fonksiyon_v.$i.'"), $elemanlar); break;';
// ---------------------------------------------------------------------------------------------------
// Döngüyü, fonksiyon sayısı kadar sürdürür
//---------------------------------------------------------------------------------------------------- 
$i--;
}
while ($i<=$fonksiyon_sayısı && $i>0);
// ---------------------------------------------------------------------------------------------------
// DİL DOSYASINA GÖRE KODU OLUŞTUR
//----------------------------------------------------------------------------------------------------
// Değişkenlerin Detayları
//----------------------------------------------------------------------------------------------------
// ---------------------------------------------------------------------------------------------------
// İndexler
//----------------------------------------------------------------------------------------------------
do
{
$değişken_sayısı = substr_count($kod, $this->değişken_v.@$i_d);
}
while(@$i_d);
// ---------------------------------------------------------------------------------------------------
// Fonksiyon sırasına göre döngü
//----------------------------------------------------------------------------------------------------
for ($i_d= $değişken_sayısı-1; $i_d<$değişken_sayısı && $i_d>0; $i_d--) {
// ---------------------------------------------------------------------------------------------------
// Değişkenleri Uyarla
//----------------------------------------------------------------------------------------------------
$kod = @str_ireplace($this->değişken_v.$i_d,$dil['$'.$i_d],$kod); 
}
// ---------------------------------------------------------------------------------------------------
// Dil dosyasına göre methodlandırma desteği
//----------------------------------------------------------------------------------------------------
$destek=$anahtar_.' function '.$kullanım.'($method, $elemanlar) { global $dil; switch ($method) { '.$orta.' default: echo"Fonksiyon ismi geçersiz."; exit; break; }}}';
// ---------------------------------------------------------------------------------------------------
// Sınıf ismini dil dosyasındaki sınıf ismiyle kullanmak için çevirir
//----------------------------------------------------------------------------------------------------
$kod = str_ireplace($this->sınıf,$dil[$this->sınıf],$kod);
// ---------------------------------------------------------------------------------------------------
// Kodu düzenle
//----------------------------------------------------------------------------------------------------
$kod = ltrim($kod);
$kod = rtrim($kod);
// ---------------------------------------------------------------------------------------------------
// Destek sağlamak için son "}" karakterini temizle
//---------------------------------------------------------------------------------------------------- 
$kod = rtrim($kod, "}");      
eval($kod.$destek);
//----------------------------------------------------------------------------------------------------
}
//
//+-------------------------------------------------------------------+  
//| = : = : = : = : = : = : = : = : = : = : = : = : = : = : = : = : = |
//|{>/-------------------------------------------------------------\<}|
//|: |                                                             | :| 
//| :|     ┌─┐┬ ┬┌─┐╔╦╗╔═╗  +-+-+-+-+ +-+-+-+-+-+-+-+ +-+-+-+-+-+-+|: | 
//|: |     ├─┘├─┤├─┘ ║║╚═╗  |l|a|n|g| |s|u|p|p|o|r|t| |s|y|s|t|e|m|| :| 
//| :|     ┴  ┴ ┴┴  ═╩╝╚═╝  +-+-+-+-+ +-+-+-+-+-+-+-+ +-+-+-+-+-+-+|: | 
//|: |_____________________________________________________________| :|
//| :|         98 101 114 107 97 121  107 97 114 97 116 97         |: |
//|: |            62 65 72 6B 61 79  6B 61 72 61 74 61             | :| 
//| :|_____________________________________________________________|: | 
//|{>\-------------------------------------------------------------/<}|
//| = : = : = : = : = : = : = : = : = : = : = : = : = : = : = : = : = |
//+-------------------------------------------------------------------+
// ---------------------------------------------------------------------------------------------------
// Uygulama Sonu
//----------------------------------------------------------------------------------------------------
 
}





    